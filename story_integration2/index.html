<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="story_creator.css">
	
	<script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.7.2.min.js"></script>
	<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
	<script src='visualEditorCanvas.js' type = 'text/javascript'></script>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>

	<script src = 'object_creator/jfile.js' type = 'text/javascript' ></script>
	<script src='Animation/animationBlocks.js' type = 'text/javascript' ></script>
	
	<script src= 'dataRequests.js' type = 'text/javascript'></script>

	<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />
	<script src="gui.js"> </script>

</head>

<body>
	<div id="logo">
		<img src="EdithLogoName.png" width=50% height=50% >
	</div>

	<div class="animationContainer">
		<canvas id="mainCanvas"></canvas>
	</div>
		

	<div class="objectContainer">
		<canvas id="objectCanvas"> </canvas>

		<div id="tabs">
  			<div id="tabs-1">
  				<script defer="defer">
  				var stage = new Kinetic.Stage({
			    container: 'tabs-1',
			    width: 540,
			    height: 300
			    });

			    var layer2 = new Kinetic.Layer();
			    var imageObj = new Image();
			    var imageObj2 = new Image();
			    var imageObj3 = new Image();
				imageObj.onload = function() {
					var image = new Kinetic.Image({
					x: 10,
					y: 50,
					image: imageObj,
					width: 100,
					height: 100,
					listening: true,
					filter: Kinetic.Filters.Brighten,
         			filterBrightness: 0
					});

					var image2 = new Kinetic.Image({
					x: 110,
					y: 50,
					image: imageObj2,
					width: 100,
					height: 100,
					listening: true,
					filter: Kinetic.Filters.Brighten,
         			filterBrightness: 0
					});

					var image3 = new Kinetic.Image({
					x: 210,
					y: 50,
					image: imageObj3,
					width: 100,
					height: 100,
					listening: true,
					filter: Kinetic.Filters.Brighten,
         			filterBrightness: 0
					});

			      	image.on('dblclick', function() {
        				addSprite(getCanvas(), 'kitten.png', 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));

      				});

			      	image2.on('dblclick', function() {
        				addSprite(getCanvas(), 'mario.jpg', 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));
      				});

			      	image3.on('dblclick', function() {
        				 addSprite(getCanvas(), 'luigi.jpg', 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));
      				});


			     var glow = [];

			      image.on('click', function() {
			      	if(glow.indexOf(image) >= 0)
			      	{
			      		var x = glow.indexOf(image);
			      		glow.splice(x, 1);
			      		image.setFilterBrightness(0);
			      		layer2.batchDraw();
			      	}
			      	else {
			      		glow.push(image);
			      		image.setFilterBrightness(100);
			      		layer2.batchDraw();
			      	}
			      });

			     image2.on('click', function() {
			     	if(glow.indexOf(image2) >= 0)
			      	{
			      		var x = glow.indexOf(image2);
			      		glow.splice(x, 1);
			      		image2.setFilterBrightness(0);
			      		layer2.batchDraw();
			      	}
			      	else {
			      		image2.setFilterBrightness(100);
			      		layer2.batchDraw();
			      		glow.push(image2);
			      	}
			      });

			     image3.on('click', function() {
			     	if(glow.indexOf(image3) >= 0)
			      	{
			      		var x = glow.indexOf(image3);
			      		glow.splice(x, 1);
			      		image3.setFilterBrightness(0);
			      		layer2.batchDraw();
			      	}
			      	else
			      	{
			      		glow.push(image3);
			      		image3.setFilterBrightness(100);
			      		layer2.batchDraw();
			      	}
			      });


				  layer2.add(image);
			      layer2.add(image2);
			      layer2.add(image3);
			      // add the layer to the stage
			      stage.add(layer2);
			  };
			   imageObj.src = 'kitten.png';
			   imageObj2.src = 'mario.jpg';
			   imageObj3.src = 'luigi.jpg';


			   var imageObj5;
			  function addImage(src)
			  {
			  	 imageObj5 = new Image();
					imageObj5.onload = function() {
					  var image5 = new Kinetic.Image({
					    x: 510,
					    y: 50,
					    image: imageObj5,
					    width: 100,
					    height: 100,
					    listening: true
					  });
				 layer2.add(image5);
				 stage.add(layer2);
				 image5.on('dblclick', function() {
        			 addSprite(getCanvas(), imageObj5, 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));
      				});
			  };
			  imageObj5.src = src;
			}
  			</script>

  		</div>

  	</div>
		</div>

		<div class="VEContainer">

			<canvas id = "VECanvas"></canvas>

			<div id= 'tabs'>
			<div id='container1'>
				
			</div>
		</div>
		</div>

		
<script>
	mainCanvas.width = (window.innerWidth / 1.8);
	mainCanvas.height = (window.innerHeight / 1.8);
	objectCanvas.width = (window.innerWidth / 1.825);
	objectCanvas.height = (window.innerHeight / 2.7);
	VECanvas.width = (window.innerWidth / 2.4);
	VECanvas.height = (window.innerHeight/1.06);

	var oCanvasElement = wrapHTMLCanvasToOcanvas(document.getElementById("mainCanvas"), '#FFFFFF');  //get the OCanvas so we can animate

	var mario = addSprite(oCanvasElement, 'Animation/mario.jpg', 100, 100, (window.innerWidth / 7.5), (window.innerHeight / 3.75));
	var luigi = addSprite(oCanvasElement, 'Animation/luigi.jpg', 90, 100, (window.innerWidth / 3.75), (window.innerHeight / 3.75));
	var bowser = addSprite(oCanvasElement, 'Animation/Bowser.jpg', 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));

	window.onresize = function(event) {
    	mainCanvas.width = (window.innerWidth / 1.8);
		mainCanvas.height = (window.innerHeight / 1.8);
		objectCanvas.width = (window.innerWidth / 1.8);
		objectCanvas.height = (window.innerHeight / 2.8);

		oCanvasElement = wrapHTMLCanvasToOcanvas(document.getElementById("mainCanvas"), '#FFFFFF');  //get the OCanvas so we can animate

		mario = addSprite(oCanvasElement, 'Animation/mario.jpg', 100, 100, (window.innerWidth / 7.5), (window.innerHeight / 3.75));
		luigi = addSprite(oCanvasElement, 'Animation/luigi.jpg', 90, 100, (window.innerWidth / 3.75), (window.innerHeight/ 3.75));
		bowser = addSprite(oCanvasElement, 'Animation/Bowser.jpg', 100, 100, (window.innerWidth / 2.5), (window.innerHeight / 3.75));
	}

	function getCanvas()
	{
		return oCanvasElement;
	}
	
	function play()
	{
		move(mario, 2000, 0, 0, true, -360);
		rotate(luigi, 400, 360);
		movD(luigi, 100, 50);
		movL(luigi, 100, 50);
		movU(luigi, 100, 50);
		movR(luigi, 100, 50);
		rotate(bowser, 200, 360, true);
		rotate(bowser, 200, 360, false);
	}

	function pauseSprite()
	{
		pauseAnimationsForSprite(mario);
	}
	function pauseAll()
	{
		pauseAnimationsForEntireScene(oCanvasElement);
	}

	function delay()
	{
		setDelay(mario, 1000);
	}
	
	/**
	/	Loads the information that the load.php page gives
	**/
	function load(){
	//$.get("load.php", function(data, status){//issue a get request for the php page 'load.php"  
	//		alert("Data: " + data + " Status: " + status);
	//	});
		$.ajax({
				url: 'Sharing Framework/edith/functions/load.php', //use the load php page to get the stuff from the database
				type: 'GET',	//get the information from the php page (the stuff that is echo in the php file);
				success: function(data) { //if it worked alert the data
					alert(data);
				},
				error: function(){//if it failed say it failed
					alert("Request Failed");
				}
		});
	}
	/**
	/Save the information for save.php to put to the server's database
	/
	**/
	function save(){
		$.ajax({
				url: 'Sharing Framework/edith/functions/save.php',
				type: 'POST',
				data: {code: "the_Project_code_here", projectName: "the_projectName_here"}, //update what the project code and name are
				success: function(){
						console.log("Succsessful post!");
				},
				error: function(){
						console.log("Failed post!");
				}
		});
	}
	
</script>
<div class="buttons">
 <button id="button1" onclick = 'play()'>Play</button>
 <button id="button2" onclick = 'pauseAll()'>Pause</button>
 <button id="button3" onclick = 'popitup("../object_creator_integration_2/ObjectCreation.html")'>Make Object</button>
 <button id="button4" onClick = 'save()'>Save</button>
 <button id="button5" onClick = 'load()'>Load</button>
</div>

</body>

</html>